| *Comment* | STARTING Test Case : Explore Spreadsheet Sidebar |  |

| clickAndWait | st-home-link |  |
| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=TC%20Hide%20Sidebar%20Spreadsheet1%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| pause | 5000 | I hate pause; needed because save button appears before page is done loading |
| click_and_wait | st-save-button-link |  |

| clickAndWait | st-home-link |  |
| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=TC%20Hide%20Sidebar%20Spreadsheet2%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| pause | 5000 | I hate pause; needed because save button appears before page is done loading |
| click_and_wait | st-save-button-link |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar sidebar should be open |  |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| wait_for_element_visible_ok | st-no-tags-placeholder | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case : Explore Spreadsheet Sidebar close the sidebar |  |
| click_ok | link=V |  |

 wait_for_element_not_visible_ok | st-page-boxes | 10000 |

| pause | 10000 |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar sidebar should be closed |  |
| text_like | st-page-boxes-toggle-link | > |

| *Comment* | Test Case : Explore Spreadsheet Sidebar open the sidebar |  |
| click_ok | link=> |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar sidebar should be open |  |
| wait_for_element_visible_ok | st-page-boxes | 30000 |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case : Explore Spreadsheet Sidebar close the sidebar navigate away |  |
| click_ok | link=V |  |
| clickAndWait | st-wiki-subnav-link-whats-new |  |
| clickAndWait | link=TC Hide Sidebar Spreadsheet1 %%start_time%% |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar sidebar should still be closed |  |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | > |

| *Comment* | Test Case : Explore Spreadsheet Sidebar open the sidebar on the second page |  |
| click_ok | link=> |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar sidebar should be open |  |
| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case : Explore Spreadsheet Sidebar navigate to original page |  |
| clickAndWait | st-wiki-subnav-link-whats-new |  |
| clickAndWait | link=TC Hide Sidebar Spreadsheet1 %%start_time%% |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar sidebar should still be open |  |
| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case: Explore Spreadsheet Sidebar - what's new |
| clickAndWait | link=Settings |  |
| clickAndWait | link=What's New |  |
| select_ok | recent_changes__changes_depth | label=Last 24 hours |
| check_ok | recent_changes__include_in_pages |  |
| select_ok | recent_changes__sidebox_changes_depth | label=2 |
| clickAndWait | Button |  |
| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet1 %%start_time%% | 30000 |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet2 %%start_time%% | 30000 |
| wait_for_element_present_ok | st-edit-button-link | 30000 |  | *Comment* | Test Case: Explore Spreadsheet Sidebar - uncheck what's new | clickAndWait | link=Settings |  |
| clickAndWait | link=What's New |  |
| uncheck_ok | recent_changes__include_in_pages |  |
| clickAndWait | Button |  |
| clickAndWait | st-home-link |  |
| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |
| wait_for_element_present_ok | st-edit-button |  |
| *Comment* | sidebar element should be completely gone, not present |  |
| wait_for_element_not_present_ok | st-recent-changes-title | 5000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar - check recently viewed |
| clickAndWait | link=Settings |  |
| clickAndWait | link=Screen Layout |  |
| check_ok | display__include_breadcrumbs |  |
| clickAndWait | Button |  |
| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet1 %%start_time%% | 30000 |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet2 %%start_time%% | 30000 |

| clickAndWait | link=Settings |  |
| clickAndWait | link=Screen Layout |  |
| uncheck_ok | display__include_breadcrumbs |  |
| clickAndWait | Button |  |

| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |  | *Comment* | Test Case: Explore Spreadsheet Sidebar Upload File |  |
| *Comment* | wikitest files should be in %%wikitest_files%% on the browser server |  |
| *Comment* | *This test only works if selenium_browser has higher powers, i.e. *chrome for firefox* |  |

| *Comment* | Test Case: Explore Spreadsheet Upload File Lightbox error checks |  |
| wait_for_element_visible_ok | st-attachments-uploadbutton | 30000 |
| click_ok | st-attachments-uploadbutton |  |

| *Comment* | Test Case: Explore Spreadsheet Upload File Lightbox Text |  |
| wait_for_text_present_ok | Upload Files | 30000 |
| text_like | st-attachments-attach-limit | Maximum file size: 50MB |

| *Comment* | Test Case: Explore Spreadsheet Close Upload file lightbox |  |
| click_ok | st-attachments-attach-closebutton |  |
| wait_for_element_visible_ok | st-attachments-uploadbutton | 30000 |
| click_ok | st-attachments-uploadbutton |  |
| wait_for_text_present_ok | Click "Browse" | 30000 |
| wait_for_element_visible_ok | st-attachments-attach-filename |  |
| pause | 1000 |  |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%aintnosuchfile.txt |

| *Comment* | Test Case: Explore Spreadsheet Upload File: Selenium can't detect the file does not exist message |  |
| wait_for_text_present_ok | Uploading | 30000 |
| wait_for_text_not_present_ok | Uploading | 30000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Upload File wikitest.doc |  |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitest.doc |
| wait_for_text_present_ok | Uploaded files: | 30000 |
| click_ok | st-attachments-attach-closebutton |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Upload File verify doc upload |  |
| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-attachments-listing | 30000 |
| text_like | //a[contains(@href,'original/wikitest.doc')] | wikitest.doc |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Upload File wikitest.pdf, wikitestzip.zip |
| wait_for_element_visible_ok | st-attachments-uploadbutton | 30000 |
| click_ok | st-attachments-uploadbutton |  |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitestzip.zip |
| wait_for_text_present_ok | Uploaded files: | 30000 |
| pause | 1000 |  |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitest.pdf |
| wait_for_text_present_ok | Uploaded files: | 30000 |
| wait_for_element_visible_ok | st-attachments-attach-closebutton | 60000 |
| click_ok | st-attachments-attach-closebutton |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Upload File verify pdf and zip uploads |  |
| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-attachments-listing | 30000 |
| text_like | //a[contains(@href,'original/wikitest.pdf')] | wikitest.pdf |
| text_like | //a[contains(@href,'original/wikitestzip.zip')] | wikitestzip.zip |

* HighPermissions

*NOTE: This test only works if selenium_browser has higher powers, i.e. *chrome for firefox*

| *Comment* | Test Case: Explore Spreadsheet Sidebar |  |
| *Comment* | wikitest files should be in %%wikitest_files%% on the browser server |  |
| *Comment* | *This test only works if selenium_browser has higher powers, i.e. *chrome for firefox* |  |

| set | manage_files_user_1 | `manage_files_%%start_time%%_1@ken.socialtext.net` |
| set | user_1_regex | `manage_files_%%start_time%%_1\@ken\.socialtext\.net` |
| set | manage_files_user_2 | `manage_files_%%start_time%%_2@ken.socialtext.net` |
| set | user_2_regex | `manage_files_%%start_time%%_2\@ken\.socialtext\.net` |
| *Comment* | Test Case: manage Files setup user_1 and user_2 |  |
| click_and_wait | link=Settings |  |
| click_and_wait | link=Time |  |
| check_ok | timezone__time_display_seconds |  |
| click_and_wait | Button |  |
| st-admin | create-user --email %%manage_files_user_1%% --password 123456 |  |
| st-admin | add-member --email %%manage_files_user_1%% --workspace %%workspace%% |  |
| st-admin | create-user --email %%manage_files_user_2%% --password 123456 |  |
| st-admin | add-member --email %%manage_files_user_2%% --workspace %%workspace%% |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files set permissions to member-only |  |
| st-admin | set-permissions --workspace %%workspace%% --permission member-only |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files user_1 uploads wikitest.doc and wikitest.pdf |  |
| st-logout |  |  |
| st-login | %%manage_files_user_1%% | 123456 |
| click_and_wait | st-home-link |  |
| click_and_wait | st-newpage-link |  |
| wait_for_element_visible_ok | link=Advanced | 30000 |
| click_ok | link=Advanced |  |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| type_ok | st-newpage-pagename-edit | Manage Files %%start_time%% |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| type_ok | wikiwyg_wikitext_textarea | Some Content For Manage Files %%start_time%% |
| click_and_wait | st-save-button-link |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files upload pdf, doc, and zip |  |
| wait_for_element_visible_ok | st-attachments-uploadbutton |  |
| click_ok | st-attachments-uploadbutton |  |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitest.pdf |
| wait_for_text_present_ok | Uploaded files: | 10000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files wikitest.pdf upload waits for the Done button |  |
| wait_for_element_visible_ok | st-attachments-attach-closebutton | 30000 |
| pause | 10000 | You have to wait for the page to repaint |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitest.doc |
| wait_for_text_present_ok | Uploaded files: | 10000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files wikitest.doc upload waits for the Done button |  |
| wait_for_element_visible_ok | st-attachments-attach-closebutton | 30000 |
| pause | 10000 | You have to wait for the page to repaint |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitestzip.zip |
| wait_for_text_present_ok | Uploaded files: | 10000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files wikitestzip.zip upload waits for the Done button |  |
| wait_for_element_visible_ok | st-attachments-attach-closebutton | 30000 |
| pause | 10000 | You have to wait for the page to repaint |

| click_ok | st-attachments-attach-closebutton |  |

| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-attachments-listing | 30000 |
| text_like | //a[contains(@href,'original/wikitest.pdf')] | wikitest.pdf |
| text_like | //a[contains(@href,'original/wikitest.doc')] | wikitest.doc |
| text_like | //a[contains(@href,'original/wikitestzip.zip')] | wikitestzip.zip |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Manage Files user_2 uploads wikitest.txt |  |
| st-logoutin | %%manage_files_user_2%% | 123456 |
| click_and_wait | link=Manage Files %%start_time%% |  |

| wait_for_element_visible_ok | st-attachments-uploadbutton |  |
| click_ok | st-attachments-uploadbutton |  |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitest.txt |
| wait_for_text_present_ok | Uploaded files: | 10000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar wikitest.txt upload waits for the Done button |  |
| wait_for_element_visible_ok | st-attachments-attach-closebutton | 30000 |
| pause | 10000 | You have to wait for the page to repaint |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Unzip File upload txt and zip |  |
| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet1_%%start_time%% |  |
| wait_for_element_visible_ok | st-attachments-uploadbutton |  |
| click_ok | st-attachments-uploadbutton |  |
| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitest.txt |
| wait_for_text_present_ok | Uploaded files: | 10000 |

| wait_for_element_visible_ok | st-attachments-attach-filename | 30000 |
| type_ok | st-attachments-attach-filename | %%wikitest_files%%wikitestzip.zip |
| wait_for_text_present_ok | Uploaded files: | 10000 |

| *Comment* | Test Case: Explore Spreadsheet Sidebar upload waits for the Done button |  |
| wait_for_element_visible_ok | st-attachments-attach-closebutton | 30000 |
| pause | 10000 | You have to wait for the page to repaint |
| click_ok | st-attachments-attach-closebutton |  |

| *Comment* | TExplore Spreadsheet Sidebar Unzip File delete the links from the page |  |
| wait_for_element_visible_ok | st-edit-button-link | 30000 |
| click_ok | st-edit-button-link |  |
| wait_for_element_visible_ok | link=Advanced | 30000 |
| click_ok | link=Advanced |  |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| type_ok | wikiwyg_wikitext_textarea | DELETE THE CONTENT OF Unzip File %%start_time%% |
| click_and_wait | st-save-button-link |  |

| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-attachments-listing | 30000 |
| text_like | //a[contains(@href,'original/wikitest.txt')] | wikitest.txt |
| text_like | //a[contains(@href,'original/wikitestzip.zip')] | wikitestzip.zip |

| *Comment* | Test Case: Explore Spreadsheet Sidebar reload the page to unzip file |  |
| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet1_%%start_time%% |  |
| click_and_wait | link=Unzip File %%start_time%% |  |
| wait_for_element_visible_ok | st-attachments-managebutton | 30000 |
| click_ok | st-attachments-managebutton |  |
| wait_for_element_visible_ok | link=extract | 30000 |
| click_ok | link=extract |  |
| wait_for_text_present_ok | publictests-2-2.xls | 30000 |
| wait_for_text_present_ok | O Star.txt | 30000 |
| wait_for_text_present_ok | Poem By Robert Frost.pdf | 30000 |
| wait_for_text_present_ok | st-logo-symbol.jpg | 30000 |
| text-like | st-attachments-manage-interface | publictests-2-2.xls |
| text-like | st-attachments-manage-interface | O Star.txt |
| text-like | st-attachments-manage-interface | Poem By Robert Frost.pdf |
| text-like | st-attachments-manage-interface | st-logo-symbol.jpg |
| click_ok | st-attachments-manage-closebutton |  |

| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet1_%%start_time%% |  |

| *Comment* | Test Case : Explore Spreadsheet Sidebar | Cleaning up |  |

| st-admin | purge-page --w %%workspace%% --page tc_hide_sidebar_spreadsheet1_%%start_time%% | The TC Hide Sidebar Spreadsheet1 %%start_time%% page was purged from the %%workspace%% workspace. |
| st-admin | purge-page --w %%workspace%% --page tc_hide_sidebar_spreadsheet2_%%start_time%% | The TC Hide Sidebar Spreadsheet2 %%start_time%% page was purged from the %%workspace%% workspace. |

| *Comment* | Test Case : Explore Spreadsheet Sidebar COMPLETED |  |
