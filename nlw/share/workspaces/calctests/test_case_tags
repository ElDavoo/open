| *Comment* | Test Case: Tags |

| *Comment* | Test Case: Tags All Tags |  |
| clickAndWait | st-wiki-subnav-link-whats-new |  |
| clickAndWait | link=All Tags |  |
| text_like | link=Welcome | Welcome |

use or create a workspace with several tags and tagged pages

| *Comment* | Test Case: Tags Create tag1 page tagged tag1 |  |
| clickAndWait | st-home-link |  |
| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=tag1%20content%20spreadsheet%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| click_and_wait | st-save-button-link |  |
| wait_for_element_visible_ok | st-tags-addlink | 30000 |
| click_ok | st-tags-addlink |  |
| wait_for_element_visible_ok | st-tags-field | 30000 |
| type_ok | st-tags-field | tag1 %%start_time%% |
| wait_for_element_visible_ok | st-tags-addbutton | 20000 |
| click_ok | st-tags-addbutton |  |

| *Comment* | Test Case: Tags. Text "Adding tag" should appear where textarea was |  |
| wait_for_text_present_ok | Adding tag | 30000 |
| *Comment* | Test Case: Tags. Wait for the tag textarea to reappear |  |
| wait_for_element_visible_ok | st-tags-field | 30000 |
| text_like | link=tag1 %%start_time%% | tag1 %%start_time%% |

| *Comment* | Test Case: Tags Create tag12 page tagged tag1 |  |
| clickAndWait | st-home-link |  |
| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=tag12%20content%20spreadsheet%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| click_and_wait | st-save-button-link |  |
| wait_for_element_visible_ok | st-tags-addlink | 30000 |
| click_ok | st-tags-addlink |  |
| wait_for_element_visible_ok | st-tags-field | 30000 |
| type_ok | st-tags-field | tag1 %%start_time%% |
| wait_for_element_visible_ok | st-tags-addbutton | 20000 |
| click_ok | st-tags-addbutton |  |

| *Comment* | Test Case: Tags. Text "Adding tag" should appear where textarea was |  |
| wait_for_text_present_ok | Adding tag | 30000 |
| *Comment* | Test Case: Tags. Wait for the tag textarea to reappear |  |
| wait_for_element_visible_ok | st-tags-field | 30000 |
| text_like | link=tag1 %%start_time%% | tag1 %%start_time%% |

| *Comment* | Test Case: Tags Create tag2 page tagged tag2 |  |
| clickAndWait | st-home-link |  |
| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=tag2%20content%20spreadsheet%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| click_and_wait | st-save-button-link |  |
| wait_for_element_visible_ok | st-tags-addlink | 30000 |
| click_ok | st-tags-addlink |  |
| wait_for_element_visible_ok | st-tags-field | 30000 |
| type_ok | st-tags-field | tag2 %%start_time%% |
| wait_for_element_visible_ok | st-tags-addbutton | 20000 |
| click_ok | st-tags-addbutton |  |

| *Comment* | Test Case: Tags. Text "Adding tag" should appear where textarea was |  |
| wait_for_text_present_ok | Adding tag | 30000 |
| *Comment* | Test Case: Tags. Wait for the tag textarea to reappear |  |
| wait_for_element_visible_ok | st-tags-field | 30000 |
| text_like | link=tag2 %%start_time%% | tag2 %%start_time%% |

click on several tag links | Category (Tag) page with table containing links to tagged pages appears
click on several page links | Pages appear; each page has its that tag displayed in Tags sidebar.

| *Comment* | Test Case: Tags Checking tag2 links and pages |  |
| clickAndWait | st-home-link |  |
| clickAndWait | st-wiki-subnav-link-all-tags |  |

| text_like | link=tag2 %%start_time%% | tag2 %%start_time%% |
| clickAndWait | link=tag2 %%start_time%% |  |
| clickAndWait | link=tag2 content spreadsheet %%start_time%% |  |
| text_like | link=tag2 %%start_time%% | tag2 %%start_time%% |

| *Comment* | Test Case: Tags Checking tag1 links and pages |  |
| clickAndWait | st-home-link |  |
| clickAndWait | st-wiki-subnav-link-all-tags |  |
| text_like | link=tag1 %%start_time%% | tag1 %%start_time%% |
| clickAndWait | link=tag1 %%start_time%% |  |
| clickAndWait | link=tag1 content spreadsheet %%start_time%% |  |
| text_like | link=tag1 %%start_time%% | tag1 %%start_time%% |

 click: View {link: Category as a weblog} | All pages with that tag appear in weblog form

| *Comment* | Test Case: Tags Checking weblog view |  |
| clickAndWait | st-home-link |  |
| clickAndWait | link=tag2 content spreadsheet %%start_time%% |  |
| clickAndWait | link=tag2 %%start_time%% |  |
| clickAndWait | link=tag2 %%start_time%% as a weblog |  |
| text_like | st-weblog-titletext | Weblog: tag2 %%start_time%% |

| *Comment* | Test Case: Tags post to category by email not implemented |

 return to Category (Tag) page | sortable table of tagged pages appears 
 Toggle sort link at top of each column | tables sort and reverse sort correctly

| *Comment* | Test Case: Tags Checking tag sorting |  |
| clickAndWait | st-home-link |  |
| clickAndWait | st-wiki-subnav-link-all-tags |  |
| text_like | qr/tag1 %%start_time%%.+tag2 %%start_time%%/ |  |
| click_ok | link=Tag |  |
| text_like | qr/tag2 %%start_time%%.+tag1 %%start_time%%/ |  |
| click_ok | link=Tag |  |
| text_like | qr/tag1 %%start_time%%.+tag2 %%start_time%%/ |  |

Delete tag from pages until tag is gone from all pages.
Go to All Tags | The deleted tag should not appear in list

| *Comment* | Test Case: Tags Delete a tag from all pages |  |
| open_ok | /%%workspace%%/index.cgi?tag1_content_spreadsheet_%%start_time%% |  |
| wait_for_element_present_ok | link=[x] | 20000 |
| click_ok | `link=[x]` |  |
| *Comment* | Test Case: Tags first wait |  |
| wait_for_text_present_ok | tags have been removed | 30000 |

| open_ok | /%%workspace%%/index.cgi?tag12_content_spreadsheet_%%start_time%% |  |
| wait_for_element_present_ok | link=[x] | 20000 |
| click_ok | `link=[x]` |  |
| *Comment* | Test Case: Tags second wait |  |
| wait_for_text_present_ok | tags have been removed | 30000 |

| click_and_wait | st-home-link |  |
| click_and_wait | st-wiki-subnav-link-all-tags |  |
| text_unlike | st-listview | tag1 %%start_time%% |

Make a new page and add a new tag (a tag not already in use in workspace) | tag is added 
 Delete this page. | Page is deleted. This tag now has zero pages. 
 Go to All Tags | The tag from the deleted page should not appear in list.

| *Comment* | Test Case: Tags. Tags with zero pages should not appear in the tag list |  |
| click_and_wait | st-home-link |  |
| click_and_wait | link=tag2 content spreadsheet %%start_time%% |  |
| click_and_wait | link=Delete Page |  |
| confirmation_like | Are you sure you want to delete this page? |  |
| click_and_wait | st-home-link |  |
| click_and_wait | st-wiki-subnav-link-all-tags |  |
| text_unlike | st-listview | tag2 %%start_time%% |

| *Comment* | Test Case: Tags Teardown |  |
| st-admin | purge-page --w %%workspace%% --page tag1_content_spreadsheet_%%start_time%% |  |
| st-admin | purge-page --w %%workspace%% --page tag12_content_spreadsheet_%%start_time%% |  |

| *Comment* | Test Case: Tags COMPLETED |
