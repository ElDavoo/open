| *Comment* | Test Case: Friendly Name 2 |


* Fixture: SocialWidgets

| include | [Test Case: Friendly Name Setup] |

| *Comment* | Test Case: Friendly Name create a wiki |  |
| st-admin | add-account-admin --account %%fname_acct%% --e %%fname_user%% | now has the role of 'admin' |
| open_ok | /%%fname_wiki%%/?action=workspaces_create |  |
| wait_for_element_visible_ok | //input[@name='title'] | 30000 |
| type_ok | //input[@name='title'] | %%fname_wiki_2%% |
| wait_for_element_visible_ok | //input[@name='name'] | 30000 |
| type_ok | //input[@name='name'] | %%fname_wiki_2%% |
| wait_for_element_visible_ok | -savelink | 30000 |
| click_and_wait | -savelink |  |
| wait_for_text_present_ok | You have just created "%%fname_wiki_2%%" |  |
| st-admin | remove-account-admin --account %%fname_acct%% --e %%fname_user%% | no longer has the role of 'admin' |
| add-group-to-workspace | %%fname_group_id%% | %%fname_wiki_2%% |
| st-admin | add-member --email %%fname_checker%% --workspace %%fname_wiki_2%% | now has the role |
| open_ok | /nlw/submit/logout |  |
| st-login | %%fname_checker%% | %%password%% |

| *Comment* | Test Case: Friendly Name check Control Panel account page |  |
| open_ok | /nlw/control/account/%%fname_acct_id%% |  |
| wait_for_text_present_ok | %%fname%% | 30000 |
| text_like | workspaces | %%fname%% |
| text_like | //div[@id='userTable'] | %%fname%% |
| text_like | groups | %%fname%% |

| *Comment* | Test Case: Friendly Name check Control Panel workspace page |  |
| open_ok | /nlw/control/account/%%fname_acct_id%% |  |
| wait_for_element_visible_ok | //a[@title='view %%fname_wiki_2%%'] | 30000 |
| click_and_wait | //a[@title='view %%fname_wiki_2%%'] |  |
| wait_for_text_present_ok | %%fname%% | 30000 |
| text_like | Created by: "%%fname%%" |  |
| text_like | //div[@id='userTable'] | %%fname%% |
| text_like | //div[@id='groupTable'] | %%fname%% |

| *Comment* | Test Case: Friendly Name check Control Panel workspaces list |  |
| open_ok | /nlw/control/workspace |  |
| wait_for_text_present_ok | %%fname%% | 30000 |
| text_like | workspaces | %%fname%% |

| *Comment* | Test Case: Friendly Name check Control Panel group page |  |
| open_ok | /nlw/control/group/%%fname_group_id%% |  |
| wait_for_text_present_ok | %%fname%% | 30000 |
| text_like | Created By: %%fname%% |  |
| text_like | //div[@id='userTable'] | %%fname%% |
| text_like | workspaces | %%fname%% |

| *Comment* | Test Case: Friendly Name check Control Panel user list |  |
| open_ok | /nlw/control/user |  |
| wait_for_element_visible_ok | user-sort-account | 30000 |
| click_and_wait | user-sort-account |  |
| wait_for_text_present_ok | %%fname%% | 30000 |
| *Comment* | %%fname%% needs to be checked for in two places within the same table, should occur exactly 4 times, no more or less |  |
| wait_for_element_visible_ok | //a[contains(text(),%%fname%%)][1] | 30000 |
| wait_for_element_visible_ok | //a[contains(text(),%%fname%%)][2] | 30000 |
| wait_for_element_visible_ok | //a[contains(text(),%%fname%%)][3] | 30000 |
| wait_for_element_visible_ok | //a[contains(text(),%%fname%%)][4] | 30000 |
| wait_for_element_not_present_ok | //a[contains(text(),%%fname%%)][5] | 30000 |

| *Comment* | Test Case: Friendly Name check Control Panel user page *broken* |  |
| wait_for_element_visible_ok | //a[contains(text(),'%%fname_checker%%')] | 30000 |
| click_and_wait | //a[contains(text(),'%%fname_checker%%')] |  |

wait_for_element_visible_ok | link=%%fname%% | 30000 |
| text_like | Invited by: "%%fname%%" | |
text_like | workspaceTable | %%fname%% |

| *Comment* | Test Case: Friendly Name check Control Panel other user page |  |
| open_ok | /nlw/control/user/%%fname_user_id%% |  |
| wait_for_text_present_ok | %%fname%% | 30000 |
| text_like | qr/%%first_name%%.+%%last_name%%.+Prefers to be called: %%fname%%/ |  |

| *Comment* | Test Case: Friendly Name check Control Panel add a user page |  |
| open_ok | /nlw/control/account/%%fname_acct_id%%/add_user |  |
| wait_for_element_visible_ok | field_preferred_name | 30000 |
| text_like | Preferred Name is calculated unless provided |  |

| include | [Test Case: Friendly Name Teardown] |
| st-admin | delete-workspace --workspace %%fname_wiki_2%% |

| *Comment* | Test Case: Friendly Name COMPLETED |
