| *Comment* | Test Case: Associate Group with Workspace |  |

* Fixture: SocialWidgets

| set | agw_acct | agw_account_%%start_time%% |
| set | agw_user | agw_user_%%start_time%%@david.socialtext.net |
| set | agw_group | agw_group_%%start_time%% |
| set | ws1 | agw1-wiki-%%start_time%% |
| set | ws2 | agw2-wiki-%%start_time%% |
| set | ws3 | agw3-wiki-%%start_time%% |
| set | ws4 | agw4-wiki-%%start_time%% |
| set | ws5 | agw5-wiki-%%start_time%% |
| set | ws6 | agw6-wiki-%%start_time%% |
| set | ws7 | agw7-wiki-%%start_time%% |
| set | ws8 | agw8-wiki-%%start_time%% |
| set | ws9 | agw9-wiki-%%start_time%% |
| set | ws10 | agw10-wiki-%%start_time%% |
| set | ws11 | agw11-wiki-%%start_time%% |
| set | ws_noadmin | noadmin-wiki-%%start_time%% |
| set | ws_noadmin_prefix | noadmin |
| set | ws_noadmin_suffix | -wiki-%%start_time%% |
| set | ws_prefix | agw |
| set | ws1_suffix | 1-wiki-%%start_time%% |
| set | ws2_suffix | 2-wiki-%%start_time%% |
| set | ws3_suffix | 3-wiki-%%start_time%% |
| set | ws4_suffix | 4-wiki-%%start_time%% |
| set | ws5_suffix | 5-wiki-%%start_time%% |
| set | ws6_suffix | 6-wiki-%%start_time%% |
| set | ws7_suffix | 7-wiki-%%start_time%% |
| set | ws8_suffix | 8-wiki-%%start_time%% |
| set | ws9_suffix | 9-wiki-%%start_time%% |
| set | ws10_suffix | 10-wiki-%%start_time%% |
| set | ws11_suffix | 11-wiki-%%start_time%% |

| create_account | %%agw_acct%% |  |
| create_user | %%agw_user%% | %%password%% | %%agw_acct%% |
| create_group | %%agw_group%% | %%agw_acct%% | %%agw_user%% |
| set | agw_group_id | %%group_id%% |  |
| create_workspace | %%ws1%% | %%agw_acct%% |  |
| create_workspace | %%ws2%% | %%agw_acct%% |  |
| create_workspace | %%ws3%% | %%agw_acct%% |  |
| create_workspace | %%ws4%% | %%agw_acct%% |  |
| create_workspace | %%ws5%% | %%agw_acct%% |  |
| create_workspace | %%ws6%% | %%agw_acct%% |  |
| create_workspace | %%ws7%% | %%agw_acct%% |  |
| create_workspace | %%ws8%% | %%agw_acct%% |  |
| create_workspace | %%ws9%% | %%agw_acct%% |  |
| create_workspace | %%ws10%% | %%agw_acct%% |  |
| create_workspace | %%ws11%% | %%agw_acct%% |  |
| create_workspace | %%ws_noadmin%% | %%agw_acct%% |  |
| add_workspace_admin | %%agw_user%% | %%ws1%% |  |
| add_workspace_admin | %%agw_user%% | %%ws2%% |  |
| add_workspace_admin | %%agw_user%% | %%ws3%% |  |
| add_workspace_admin | %%agw_user%% | %%ws4%% |  |
| add_workspace_admin | %%agw_user%% | %%ws5%% |  |
| add_workspace_admin | %%agw_user%% | %%ws6%% |  |
| add_workspace_admin | %%agw_user%% | %%ws7%% |  |
| add_workspace_admin | %%agw_user%% | %%ws8%% |  |
| add_workspace_admin | %%agw_user%% | %%ws9%% |  |
| add_workspace_admin | %%agw_user%% | %%ws10%% |  |
| add_workspace_admin | %%agw_user%% | %%ws11%% |  |

| *Comment* | Test Case: Associate Group With Workspace user cannot add workspace if he is not admin |  |
| st-logoutin | %%agw_user%% | %%password%% |
| open_ok | /st/edit_group/%%agw_group_id%% |  |
| wait_for_text_present_ok | Edit Group: %%agw_group%% | 30000 |
| st-name-widget | 2 | wiki |
| st-widget-title-like | wiki | Workspaces |
| st-select-widget-frame | wiki |  |
| wait_for_text_present_ok | Currently, there are no workspaces associated with this group. | 30000 |
| wait_for_text_present_ok | Use the input above to select workspaces to associate with this group. | 30000 |
| wait_for_element_visible_ok | lookahead | 30000 |
| type_lookahead_ok | lookahead | %%ws_noadmin_prefix%% |
| select-frame | relative=parent |  |
| wait_for_text_present_ok | No matches for '%%ws_noadmin_prefix%%' | 30000 |
| wait_for_element_not_present_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws_noadmin_suffix%%')] | 30000 |

| *Comment* | Test Case: Associate Group With Workspace test lookahead functionality |  |
| st-select-widget-frame | wiki |  |
| wait_for_element_visible_ok | lookahead | 30000 |
| type_lookahead_ok | lookahead | %%ws_prefix%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws1_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws2_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws3_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws4_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws5_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws6_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws7_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws8_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws10_suffix%%')] | 30000 |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws11_suffix%%')] | 30000 |
| wait_for_element_not_present_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws9_suffix%%')] | 30000 |

| *Comment* | Test Case: Associate Group With Workspace add one wiki, check that final wiki shows up in lookahead |  |
| click_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws1_suffix%%')] |  |
| st-select-widget-frame | wiki |  |
| wait_for_element_visible_ok | link=%%ws1%% | 30000 |
| type_lookahead_ok | lookahead | %%ws_prefix%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | //div[@class='lookaheadItem']/a[contains(text(),'%%ws9_suffix%%')] | 30000 |




| *Comment* | Test Case: Associate Group With Workspace TEARDOWN |  |
| st-admin | deactivate-user --email %%agw_user%% | removed |
| delete-group | %%agw_group_id%% |  |
| st-admin | delete-workspace --workspace %%ws1%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws2%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws3%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws4%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws5%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws6%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws7%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws8%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws9%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws10%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws11%% --no-export | deleted |
| st-admin | delete-workspace --workspace %%ws_noadmin%% --no-export | deleted |
