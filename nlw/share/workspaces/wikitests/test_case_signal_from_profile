| *Comment* | Test Case: Signal From Profile |  |

* Fixture: SocialWidgets

| set | spuser | spuser-%%start_time%%@ken.socialtext.net |
| create-user | %%spuser%% | %%password%% |
| st-admin | enable-plugin --all-accounts --plugin signals |  |
| st-logoutin | %%spuser%% |  |

| *Comment* | Test Case: Signal From Profile. logged in user has empty "lastsignal" |  |

| open_ok | /st/profile |  |
| wait_for_element_present_ok | //div[@id='lastsignal'] | 30000 |
| wait_for_element_not_present_ok | //div[@id='lastsignal']/a | 5000 |

| *Comment* | Test Case: Signal From Profile. %%spuser%% public mention another user from other user's profile |  |
| *Comment* | Test Case: Signal From Profile. it is safe to let the other user be wikitester@ken.socialtext.net |  |

| set | signal | Public Hello to wikitester from %%spuser%% |

| st-find-user | wikitester |  |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 3 | activities |
| st-widget-title-like | activities | Activities |
| st-send-signal-via-activities-widget | activities | %%signal%% |

| *Comment* | Test Case: Signal From Profile. Public mention appears in wikitester profile activities widget |  |
| st-verify-text-in-activities-widget | activities | %%signal%% |

| *Comment* | Test Case: Signal From Profile. Public mention appears in %%spuser%% profile activities widget |  |
| open_ok | /st/profile |  |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 3 | spactivities |
| st-widget-title-like | spactivities | Activities |
| st-verify-text-in-activities-widget | spactivities | %%signal%% |
| wait_for_element_visible_ok | //div[@id='lastsignal']/a[contains(text(),'wikitester')] | 5000 |
| text_like | //div[@id='lastsignal'] | %%signal%% |

| *Comment* | Test Case: Signal From Profile. Public mention appears in %%spuser%% Signal page activities widget |  |
| click_and_wait | link=Signals |  |
| wait_for_text_present_ok | Signals | 30000 |
| st-name-widget | 1 | sigactivities |
| st-verify-text-in-activities-widget | sigactivities | %%signal%% |

| *Comment* | Test Case: Signal From Profile. Public mention appears in %%spuser%% Dashboard activities widget |  |
| st-single-widget-in-dashboard | gallery-widget-Activities |  |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | dbactivities |
| st-verify-text-in-activities-widget | dbactivities | %%signal%% |

| *Comment* | Test Case: Signal From Profile. %%spuser%% private mention from other user's profile |  |
| *Comment* | Test Case: Signal From Profile. it is safe to let the other user be wikitester@ken.socialtext.net |  |

| set | private | Private Hello to wikitester from %%spuser%% |  |

| st-find-user | wikitester |  |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 3 | activities |
| st-widget-title-like | activities | Activities |
| st-send-signal-via-activities-widget | activities | %%private%% | PRIVATE |

| *Comment* | Test Case: Signal From Profile. Private mention appears in wikitester profile activities widget |  |
| st-verify-text-in-activities-widget | activities | %%private%% |

| *Comment* | Test Case: Signal From Profile. private mention appears in %%spuser%% profile activities widget |  |
| open_ok | /st/profile |  |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 3 | spactivities |
| st-widget-title-like | spactivities | Activities |
| st-verify-text-in-activities-widget | spactivities | %%private%% |

| *Comment* | Test Case: Signal From Profile. Private mention appears in %%spuser%% signal activities widget |  |
| click_and_wait | link=Signals |  |
| wait_for_text_present_ok | Signals | 30000 |
| st-name-widget | 1 | sigactivities |
| st-verify-text-in-activities-widget | sigactivities | %%signal%% |

| *Comment* | Test Case: Signal From Profile. private mention appears in %%spuser%% dashboard activities widget |  |
| st-single-widget-in-dashboard | gallery-widget-Activities |  |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | dbactivities |
| st-widget-title-like | dbactivities | Activities |
| st-verify-text-in-activities-widget | dbactivities | %%private%% |

TODO: login as wikitester, see public and private signals
TODO: login as another user, see public but not private signal. See public "last message" but not private

| *Comment* | Test Case: Signal From Profile COMPLETED |  |
