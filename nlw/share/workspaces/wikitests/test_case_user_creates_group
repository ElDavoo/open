| *Comment* | Test Case: User Creates Group |

* Fixture: SocialWidgets

| *Comment* | Test Case: User Creates Group Setup |  |
| set | groupname | ucg group %%start_time%% |
| set | groupuser | ucg_user_%%start_time%% |
| set | short_groupuser | ucg user %%start_time%% |
| set | groupemail | %%groupuser%%@ken.socialtext.net |

| create-user | %%groupemail%% | %%password%% |

| *Comment* | Test Case: User Creates Group disabled, try create group |  |
| st-admin | disable-plugin --plugin groups --all-accounts |  |
| open | /?create_group |  |
| text_like | //body | You do not have permission to view this page |

| *Comment* | Test Case: User Creates Group enabled, create group |  |
| st-admin | enable-plugin --plugin groups --all-accounts | The groups plugin is now enabled for all accounts |

| st-logoutin | %%groupemail%% | %%password%% |

| *Comment* | Test Case: User Creates Group enabled, check group popup buttons |  |
| wait_for_element_present_ok | link=Create Group... | 30000 |
| click_ok | link=Create Group... |  |
| wait_for_element_visible_ok | st-create-group-next | 30000 |
| wait_for_element_visible_ok | st-lightbox-cancel-create-group | 30000 |
| click_ok | st-lightbox-cancel-create-group | 30000 |
| wait_for_element_not_present_ok | st-create-group-next | 30000 |
| wait_for_element_not_present_ok | st-lightbox-cancel-create-group | 30000 |

| *Comment* | Test Case: User Creates Group enabled, create group |  |
| wait_for_element_present_ok | link=Create Group... | 30000 |
| click_ok | link=Create Group... |  |
| wait_for_element_visible_ok | st-create-group-next | 30000 |
| wait_for_element_visible_ok | st-lightbox-cancel-create-group | 30000 |
| click_and_wait | st-create-group-next |  |
| wait_for_element_visible_ok | link=? | 30000 |
| wait_for_element_visible_ok | create-group | 30000 |
| text_like | //body | Create a Group |

| *Comment* | Test Case: User Creates Group. Actually Create a Group |  |
| st-name-widget | 1 | create_group |
| st-select-widget-frame | create_group |  |
| wait_for_element_visible_ok | name | 30000 |
| wait_for_element_visible_ok | description | 30000 |
| wait_for_element_visible_ok | upload | 30000 |
| wait_for_element_visible_ok | reset | 30000 |
| type_ok | name | %%groupname%% |
| type_ok | description | Стоял он, дум великих полн, |
| select-frame | relative=parent |  |

| wait_for_element_visible_ok | create-group | 30000 |
| click_and_wait | create-group |  |

| *Comment* | Test Case: User Creates Group. Inspect New Group Page |  |
| wait_for_text_present_ok | %%groupname%% | 30000 |
| st-name-widget | 1 | information_widget |
| st-widget-title-like | information_widget | Information |
| st-select-widget-frame | information_widget |  |
| text_like | //body | Administrators |
| text_like | //body | %%groupuser%% |
| select-frame | relative=parent |  |

| *Comment* | Test Case: User Creates Group. Inspect New Group Page Workspaces |  |
| st-name-widget | 2 | workspaces_widget |
| st-widget-title-like | workspaces_widget | Workspaces |
| st-select-widget-frame | workspaces_widget |  |
| wait_for_text_present_ok | This group is not a member of any workspaces | 30000 |
| select-frame | relative=parent |  |

| *Comment* | Test Case: User Creates Group. Inspect New Group Page Activities Widget |  |
| st-name-widget | 3 | activity_widget |
| st-widget-title-like | activity_widget | Activities |
| select-frame | relative=parent |  |

| *Comment* | Test Case: User Creates Group. Inspect New Group Page Membership |  |
| st-name-widget | 4 | people_widget |
| st-widget-title-like | people_widget | Membership |
| st-select-widget-frame | people_widget |  |
| wait_for_element_visible_ok | //a[contains(@href,'?profile')] | 30000 |
| wait_for_text_present_ok | %%short_groupuser%% | 30000 |
| select-frame | relative=parent |  |

| *Comment* | Test Case: User Creates Group. Create Identical Group Name |  |
| wait_for_element_present_ok | link=Create Group... | 30000 |
| click_ok | link=Create Group... |  |
| wait_for_element_visible_ok | st-create-group-next | 30000 |
| wait_for_element_visible_ok | st-lightbox-cancel-create-group | 30000 |
| click_and_wait | st-create-group-next |  |
| wait_for_element_visible_ok | link=? | 30000 |
| wait_for_element_visible_ok | create-group | 30000 |
| st-name-widget | 1 | create_group |
| st-select-widget-frame | create_group |  |
| wait_for_element_visible_ok | name | 30000 |
| wait_for_element_visible_ok | description | 30000 |
| type_ok | name | %%groupname%% |
| select-frame | relative=parent |  |

| *Comment* | Test Case: User Creates Group. Create Identical Group Name, see error |  |
| wait_for_element_visible_ok | create-group | 30000 |
| click_ok | create-group |  |
| wait_for_text_present_ok | group already exists | 10000 |

| *Comment* | Test Case: User Creates Group. Test the cancel button, go to Dashboard |  |
| wait_for_element_present_ok | link=Create Group... | 30000 |
| click_ok | link=Create Group... |  |
| wait_for_element_visible_ok | st-create-group-next | 30000 |
| wait_for_element_visible_ok | st-lightbox-cancel-create-group | 30000 |
| click_and_wait | st-create-group-next |  |
| wait_for_element_visible_ok | link=? | 30000 |
| wait_for_element_visible_ok | create-group | 30000 |
| wait_for_element_visible_ok | st-cancel-create-group | 30000 |
| click_and_wait | st-cancel-create-group |  |
| text_like | Welcome |  |

| *Comment* | Test Case: User Creates Group. Try UTF-8 group name |  |
| set | groupname | ἀπὸ τὸ Ἄξιον ἐστί %%start_time%% |

| *Comment* | Test Case: User Creates Group named %%groupname%%. |  |
| st-admin | create-group --name "%%groupname%%" --email %%groupemail%% | %%groupname%% Group has been created |

| *Comment* | Test Case: User Creates Group. Create Identical Group Name |  |
| open | /?create_group |  |
| wait_for_element_visible_ok | link=? | 30000 |
| wait_for_element_visible_ok | create-group | 30000 |
| st-name-widget | 1 | create_group |
| st-select-widget-frame | create_group |  |
| wait_for_element_visible_ok | name | 30000 |
| wait_for_element_visible_ok | description | 30000 |
| type_ok | name | %%groupname%% |
| select-frame | relative=parent |  |

| *Comment* | Test Case: User Creates Group. Create Identical Group Name %%groupname%%, see error |  |
| wait_for_element_visible_ok | create-group | 30000 |
| click_ok | create-group |  |
| wait_for_text_present_ok | group already exists | 10000 |

| *Comment* | Test Case: User Creates Group COMPLETED |
