| *Comment* | Test Case: Signals/Activities Interaction |  |

* Fixture: SocialWidgets

| *Comment* | Test Case: Signals/Activities Interaction - Setup |  |  |
| set | mainuser | main-%%start_time%% |  |
| set | emainuser | %%mainuser%%@ken.socialtext.net |  |
| set | friend | friend-user-%%start_time%% |  |
| set | efriend | %%friend%%@ken.socialtext.net |  |
| set | followed | fuser%%start_time%% |  |
| set | efollowed | %%followed%%@ken.socialtext.net |  |
| set | conversant | conversant-user-%%start_time%% |  |
| set | econversant | %%conversant%%@ken.socialtext.net |  |
| set | second | seconduser%%start_time%% |  |
| set | esecond | %%second%%@ken.socialtext.net |  |
| set | wsadmin | wsadmin%%start_time%% |  |
| set | ewsadmin | %%wsadmin%%@ken.socialtext.net |  |
| set | acct | signalacct%%start_time%% |  |
| set | ws | signalws%%start_time%%-ws |  |
| set | secondaryacct | secondary%%start_time%% |  |
| set | secondws | secondws-%%start_time%% |  |
| create-account | %%acct%% |  |  |
| create-account | %%secondaryacct%% |  |  |
| create-workspace | %%ws%% | %%acct%% |  |
| create-workspace | %%secondws%% | %%secondaryacct%% |  |
| create-user | %%emainuser%% | %%password%% | %%acct%% |
| create-user | %%efollowed%% | %%password%% | %%acct%% |
| create-user | %%efriend%% | %%password%% | %%acct%% |
| create-user | %%econversant%% | %%password%% | %%acct%% |
| create-user | %%esecond%% | %%password%% | %%secondaryacct%% |
| create-user | %%ewsadmin%% | %%password%% | %%acct%% |
| add-member | %%emainuser%% | %%ws%% |  |
| add-member | %%econversant%% | %%ws%% |  |
| add-member | %%emainuser%% | %%secondws%% |  |
| add-member | %%esecond%% | %%secondws%% |  |
| add-member | %%efollowed%% | %%ws%% |  |
| add-member | %%ewsadmin%% | %%ws%% |  |
| st-admin | enable-plugin --plugin people --account %%acct%% |  |  |
| st-admin | enable-plugin --plugin signals --account %%acct%% |  |  |
| st-admin | enable-plugin --plugin people --account %%secondaryacct%% |  |  |
| st-admin | enable-plugin --plugin signals --account %%secondaryacct%% |  |  |
| add_workspace_admin | %%ewsadmin%% | %%ws%% |  |

enable-acct-plugin | people | %%acct%% | |
enable-acct-plugin | signals | %%acct%% | |
enable-acct-plugin | people | %%secondaryacct%% | |
enable-acct-plugin | signals | %%secondaryacct%% | |

| *Comment* | Test Case: Signals/Activities Interaction Summary Signal |  |
| st-logoutin | %%emainuser%% | %%password%% |
| open_ok | /%%ws%%/index.cgi?Edit Summary Signal %%start_time%% |  |
| wait_for_element_visible_ok | st-edit-button-link | 30000 |
| click_ok | st-edit-button-link |  |
| wait_for_element_visible_ok | link=Wiki Text | 30000 |
| click_ok | link=Wiki Text |  |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| wait_for_element_present_ok | st-edit-summary-text-area | 30000 |
| click_ok | st-edit-summary-text-area |  |
| type_ok | st-edit-summary-text-area | Super Edit Summary From Signal %%start_time%% |
| click_ok | st-edit-summary-signal-checkbox |  |
| click_and_wait | st-save-button-link |  |

| *Comment* | Test Case: Signals/Activities Add Activities widget |  |
| open_ok | /?dashboard | 60000 |
| st-empty-container |  |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| click_and_wait | link=Add Content |  |
| wait_for_element_visible_ok | //a[@id='gallery-widget-Activities'] | 30000 |
| click_and_wait | //a[@id='gallery-widget-Activities'] |  |
| wait_for_text_present_ok | Welcome | 30000 |
| text_like | st-editing-tools-edit | Welcome |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | signals_widget |
| st-widget-title-like | signals_widget | Activities |
| st-select-widget-frame | signals_widget |  |

| *Comment* | Test Case: Signals/Activities Interaction Signal, Mention, Reply, Edit Summaries, Delete |  |
| wait_for_element_visible_ok | expand-input | 10000 |
| click_ok | expand-input |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | %%mainuser%% simple signals |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 4000 |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | {user: %%efriend} mention |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| *Comment* | Test Case: Signals Widget. Signals must be spaced by at least two seconds |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case:Signals/Activities Interaction Start following %%followed%% |  |
| wait_for_element_visible_ok | link=People | 30000 |
| click_and_wait | link=People |  |
| text_like | All People |  |
| wait_for_element_visible_ok | st-search-term | 30000 |
| type_ok | st-search-term | %%efollowed%% |
| click_and_wait | st-search-submit |  |
| wait_for_element_visible_ok | link=%%followed%% | 30000 |
| click_and_wait | link=%%followed%% |  |
| wait_for_element_visible_ok | link=Follow this person | 30000 |
| click_ok | link=Follow this person |  |
| wait_for_element_visible_ok | link=Stop following this person | 30000 |

| *Comment* | Test Case: Signals/Activities Interaction As someone I follow |  |
| st-logoutin | %%efollowed%% | %%password%% |
| open_ok | /?dashboard | 60000 |
| st-empty-container |  |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| click_and_wait | link=Add Content |  |
| wait_for_element_visible_ok | //a[@id='gallery-widget-Activities'] | 30000 |
| click_and_wait | //a[@id='gallery-widget-Activities'] |  |
| wait_for_text_present_ok | Welcome | 30000 |
| text_like | st-editing-tools-edit | Welcome |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | signals_widget |
| st-widget-title-like | signals_widget | Activities |
| st-select-widget-frame | signals_widget |  |

| *Comment* | Test Case: Signals/Activities Interaction %%efollowed%% Signal, Mention, Reply, Edit Summaries, Delete |  |
| wait_for_element_visible_ok | expand-input | 10000 |
| click_ok | expand-input |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | %%followed%% simple signal |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | {user: %%emainuser%%} mention from %%followed%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | d {user: %%emainuser%%} direct from %%followed%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Signals/Activities Interaction As %%efriend%% - just someone in my acct |  |
| st-logoutin | %%efriend%% | %%password%% |
| open_ok | /?dashboard | 60000 |
| st-empty-container |  |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| click_and_wait | link=Add Content |  |
| wait_for_element_visible_ok | //a[@id='gallery-widget-Activities'] | 30000 |
| click_and_wait | //a[@id='gallery-widget-Activities'] |  |
| wait_for_text_present_ok | Welcome | 30000 |
| text_like | st-editing-tools-edit | Welcome |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | signals_widget |
| st-widget-title-like | signals_widget | Activities |
| st-select-widget-frame | signals_widget |  |
| wait_for_element_visible_ok | expand-input | 10000 |
| click_ok | expand-input |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | %%friend%% simple signal |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | {user: %%emainuser%%} mention from %%friend%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | d {user: %%emainuser%%} direct from %%friend%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Signals/Activities Interaction Signal from someone else/conversation |  |
| st-logoutin | %%econversant%% | %%password%% |
| open_ok | /%%ws%%/index.cgi?Edit Summary Signal %%start_time%% |  |
| wait_for_element_visible_ok | st-edit-button-link | 30000 |
| click_ok | st-edit-button-link |  |
| wait_for_element_visible_ok | link=Wiki Text | 30000 |
| click_ok | link=Wiki Text |  |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| wait_for_element_present_ok | st-edit-summary-text-area | 30000 |
| click_ok | st-edit-summary-text-area |  |
| type_ok | st-edit-summary-text-area | Someone Else's Edit Summary From Signal %%start_time%% |
| click_ok | st-edit-summary-signal-checkbox |  |
| click_and_wait | st-save-button-link |  |
| st-empty-container |  |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| click_and_wait | link=Add Content |  |
| wait_for_element_visible_ok | //a[@id='gallery-widget-Activities'] | 30000 |
| click_and_wait | //a[@id='gallery-widget-Activities'] |  |
| wait_for_text_present_ok | Welcome | 30000 |
| text_like | st-editing-tools-edit | Welcome |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | signals_widget |
| st-widget-title-like | signals_widget | Activities |
| st-select-widget-frame | signals_widget |  |
| wait_for_element_visible_ok | expand-input | 10000 |
| click_ok | expand-input |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | %%conversant%% simple signal |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | {user: %%emainuser%%} mention from %%conversant%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | d {user: %%emainuser%%} direct from %%conversant%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Signals/Activities Interaction Signal from different account |  |
| st-logoutin | %%esecond%% | %%password%% |
| open_ok | /?dashboard | 60000 |
| st-empty-container |  |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| click_and_wait | link=Add Content |  |
| wait_for_element_visible_ok | //a[@id='gallery-widget-Activities'] | 30000 |
| click_and_wait | //a[@id='gallery-widget-Activities'] |  |
| wait_for_text_present_ok | Welcome | 30000 |
| text_like | st-editing-tools-edit | Welcome |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | signals_widget |
| st-widget-title-like | signals_widget | Activities |
| st-select-widget-frame | signals_widget |  |
| wait_for_element_visible_ok | expand-input | 10000 |
| click_ok | expand-input |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | %%second%% simple signal |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | {user: %%emainuser%%} mention from %%second%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | d {user: %%emainuser%%} direct from %%second%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Signals/Activities Interaction As %%wsadmin%% - a workspace admin |  |
| st-logoutin | %%ewsadmin%% | %%password%% |
| open_ok | /?dashboard | 60000 |
| st-empty-container |  |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| click_and_wait | link=Add Content |  |
| wait_for_element_visible_ok | //a[@id='gallery-widget-Activities'] | 30000 |
| click_and_wait | //a[@id='gallery-widget-Activities'] |  |
| wait_for_text_present_ok | Welcome | 30000 |
| text_like | st-editing-tools-edit | Welcome |
| wait_for_text_present_ok | Activities | 30000 |
| st-name-widget | 1 | signals_widget |
| st-widget-title-like | signals_widget | Activities |
| st-select-widget-frame | signals_widget |  |
| wait_for_element_visible_ok | expand-input | 10000 |
| click_ok | expand-input |  |
| wait_for_element_visible_ok | signalFrame | 10000 |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | %%wsadmin%% simple signal |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | {user: %%emainuser%%} mention from %%wsadmin%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |
| pause | 3000 |  |
| selectFrame | signalFrame |  |
| wait_for_element_visible_ok | //body | 10000 |
| type_ok | //body | d {user: %%emainuser%%} direct from %%wsadmin%% |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | post | 10000 |
| click_ok | post |  |
| pause | 3000 |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Signals/Activities Teardown |  |
| open_ok | /?dashboard | 60000 |
| st-catchup-logs |  |  |

| *Comment* | Test Case: Signals/Activities Interaction |  |
