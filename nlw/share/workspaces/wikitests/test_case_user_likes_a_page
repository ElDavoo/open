| *Comment* | Test Case: User Likes a Page |  |

| set | user1 | user.one.%%start_time%%@david.socialtext.net |
| set | user2 | user.two.%%start_time%%@david.socialtext.net |
| set | acct | like-account-%%start_time%% |
| set | wiki | like-wiki-%%start_time%% |

| create_account | %%acct%% |  |  |
| create_workspace | %%wiki%% | %%acct%% |  |
| create_user | %%user1%% | %%password%% | %%acct%% |
| create_user | %%user2%% | %%password%% | %%acct%% |

| st-admin | add-member --workspace %%wiki%% --email %%user1%% | now has the role |
| st-admin | add-member --workspace %%wiki%% --email %%user2%% | now has the role |
| st-admin | enable-plugin --all-accounts --p like |  |
| st-admin | update-page --email %%user1%% --workspace %%wiki%% --page "%%wiki%%" < %%wikitest_client_files%%wikitest.txt | created |

| *Comment* | Test Case: User Likes a Page first user likes the page, sees the proper icons |  |
| st-logoutin | %%user1%% | %%password%% |
| open_ok | /%%wiki%% |  |
| wait_for_text_present_ok | 0 likes | 30000 |
| wait_for_element_visible_ok | //a[@class='like-indicator '] | 30000 |
| click_ok | //a[@class='like-indicator '] |  |
| wait_for_text_present_ok | 1 like | 30000 |
| open_ok | /%%wiki%% |  |
| wait_for_element_visible_ok | //a[@class='like-indicator me'] | 30000 |

| *Comment* | Test Case: User Likes a Page second user likes the page, sees the proper icons |  |
| st-logoutin | %%user2%% | %%password%% |
| open_ok | /%%wiki%% |  |
| wait_for_text_present_ok | 1 like | 30000 |
| wait_for_element_visible_ok | //a[@class='like-indicator others'] | 30000 |
| click_ok | //a[@class='like-indicator others'] |  |
| wait_for_text_present_ok | 2 likes | 30000 |
| open_ok | /%%wiki%% |  |
| wait_for_element_visible_ok | //a[@class='like-indicator me others'] | 30000 |

| *Comment* | Test Case: User Likes a Page edit the page so it will have multiple revisions to like |  |
| wait_for_element_visible_ok | st-edit-button-link | 30000 |
| click_ok | st-edit-button-link |  |
| wait_for_element_visible_ok | link=Wiki Text | 30000 |
| click_ok | link=Wiki Text |  |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| type_ok | wikiwyg_wikitext_textarea | Revised |
| st-page-save |  |  |

| *Comment* | Test Case: User Likes a page check that revisions have proper like numbers |  |
| wait_for_element_visible_ok | controls-right-revisions | 30000 |
| click_and_wait | controls-right-revisions |  |
| wait_for_text_present_ok | 0 likes | 30000 |
| wait_for_element_visible_ok | //span[@class='like-indicator '] | 30000 |
| wait_for_text_present_ok | 2 likes | 30000 |
| wait_for_element_visible_ok | //span[@class='like-indicator me others'] | 30000 |
| text_like | qr/Revision 2.+0 likes.+Revision 1.+2 likes/ |  |

| *Comment* | Test Case: User Likes a page second user unlikes and relikes the page, 2nd revision now has a like |  |
| wait_for_element_visible_ok | link=Back To Current Revision | 30000 |
| click_and_wait | link=Back To Current Revision |  |
| wait_for_text_present_ok | Revised | 30000 |
| wait_for_element_visible_ok | //a[@class='like-indicator me others'] | 30000 |
| click_ok | //a[@class='like-indicator me others'] |  |
| wait_for_text_present_ok | 1 like | 30000 |
| open_ok | /%%wiki%% |  |
| wait_for_element_visible_ok | //a[@class='like-indicator others'] | 30000 |
| click_ok | //a[@class='like-indicator others'] |  |
| wait_for_text_present_ok | 2 likes | 30000 |
| wait_for_element_visible_ok | controls-right-revisions | 30000 |
| click_and_wait | controls-right-revisions |  |
| wait_for_text_present_ok | 1 like | 30000 |
| wait_for_element_visible_ok | //span[@class='like-indicator me'] | 30000 |
| wait_for_text_present_ok | 2 likes | 30000 |
| text_like | qr/Revision 2.+1 like.+Revision 1.+2 likes/ |  |





| *Comment* | Test Case: User Like a Page TEARDOWN |  |
| deactivate-user | %%user1%% | was deactivated |
| deactivate-user | %%user2%% |  |
| delete-workspace | %%wiki%% | Recklessly deleting |
| delete-account | %%acct%% | Recklessly deleting |
