| *Comment* | STARTING Test Case: Calc Explore Spreadsheet Sidebar |  |

| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=TC%20Hide%20Sidebar%20Spreadsheet1%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| pause | 5000 | I hate pause; needed because save button appears before page is done loading |
| click_and_wait | st-save-button-link |  |

| open_ok | %%workspace%%/index.cgi?action=display;page_type=spreadsheet;page_name=TC%20Hide%20Sidebar%20Spreadsheet2%20%%start_time%%#edit |  |
| wait_for_element_visible_ok | st-save-button-link | 30000 |
| pause | 5000 | I hate pause; needed because save button appears before page is done loading |
| click_and_wait | st-save-button-link |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar sidebar should be open |  |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| wait_for_element_visible_ok | st-no-tags-placeholder | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case: Explore Spreadsheet Sidebar close the sidebar |  |
| click_ok | link=V |  |

 wait_for_element_not_visible_ok | st-page-boxes | 10000 |

| pause | 10000 |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar sidebar should be closed |  |
| text_like | st-page-boxes-toggle-link | > |

| *Comment* | Test Case: Explore Spreadsheet Sidebar open the sidebar |  |
| click_ok | link=> |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar sidebar should be open |  |
| wait_for_element_visible_ok | st-page-boxes | 30000 |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case: Explore Spreadsheet Sidebar close the sidebar navigate away |  |
| click_ok | link=V |  |
| clickAndWait | st-wiki-subnav-link-whats-new |  |
| clickAndWait | link=TC Hide Sidebar Spreadsheet1 %%start_time%% |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar sidebar should still be closed |  |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | > |

| *Comment* | Test Case: Explore Spreadsheet Sidebar open the sidebar on the second page |  |
| click_ok | link=> |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar sidebar should be open |  |
| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case: Explore Spreadsheet Sidebar navigate to original page |  |
| clickAndWait | st-wiki-subnav-link-whats-new |  |
| clickAndWait | link=TC Hide Sidebar Spreadsheet1 %%start_time%% |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar sidebar should still be open |  |
| wait_for_element_visible_ok | st-attachments-title | 30000 |
| wait_for_element_visible_ok | st-page-boxes-toggle-link | 30000 |
| text_like | st-page-boxes-toggle-link | V |
| text_like | st-no-tags-placeholder | There are no tags for this page. |
| text_like | //p | There are no pages that link to this page yet. |
| text_like | st-attachments-title | Attachments |

| *Comment* | Test Case: Calc Explore Spreadsheet Sidebar - what's new |
| clickAndWait | link=Settings |  |
| clickAndWait | link=What's New |  |
| select_ok | recent_changes__changes_depth | label=Last 24 hours |
| check_ok | recent_changes__include_in_pages |  |
| select_ok | recent_changes__sidebox_changes_depth | label=2 |
| clickAndWait | Button |  |

| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet1 %%start_time%% | 30000 |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet2 %%start_time%% | 30000 |
| wait_for_element_present_ok | st-edit-button-link | 30000 |

| *Comment* | Test Case: Calc Explore Spreadsheet Sidebar - uncheck what's new |
| clickAndWait | link=Settings |  |
| clickAndWait | link=What's New |  |
| uncheck_ok | recent_changes__include_in_pages |  |
| clickAndWait | Button |  |

| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |
| wait_for_element_visible_ok | st-edit-button |  |

| *Comment* | sidebar element should be completely gone, not present |  |
| wait_for_element_not_present_ok | st-recent-changes-title | 5000 |

| *Comment* | Test Case: Calc Explore Spreadsheet Sidebar - check recently viewed |
| clickAndWait | link=Settings |  |
| clickAndWait | link=Screen Layout |  |
| check_ok | display__include_breadcrumbs |  |
| clickAndWait | Button |  |

| open_ok | /%%workspace%%/index.cgi?tc_hide_sidebar_spreadsheet2_%%start_time%% |  |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet1 %%start_time%% | 30000 |
| wait_for_element_present_ok | link=TC Hide Sidebar Spreadsheet2 %%start_time%% | 30000 |

| clickAndWait | link=Settings |  |
| clickAndWait | link=Screen Layout |  |
| uncheck_ok | display__include_breadcrumbs |  |
| clickAndWait | Button |  |

| *Comment* | Test Case: Calc Explore Spreadsheet Sidebar Upload File |  |
| *Comment* | Removed file upload tests since they are duplicates of other file upload tests |  |

| *Comment* | Test Case: Explore Spreadsheet Sidebar Teardown |  |

| st-admin | purge-page --w %%workspace%% --page tc_hide_sidebar_spreadsheet1_%%start_time%% | The TC Hide Sidebar Spreadsheet1 %%start_time%% page was purged from the %%workspace%% workspace. |
| st-admin | purge-page --w %%workspace%% --page tc_hide_sidebar_spreadsheet2_%%start_time%% | The TC Hide Sidebar Spreadsheet2 %%start_time%% page was purged from the %%workspace%% workspace. |

| *Comment* | Test Case: Explore Spreadsheet Sidebar COMPLETED |  |
