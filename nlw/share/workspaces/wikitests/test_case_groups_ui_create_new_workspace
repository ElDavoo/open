| *Comment* | Test Case: Groups UI Create New Workspace |

* Fixture: SocialWidgets

| *Comment* | Test Case: Groups UI Create New Workspace SETUP |  |  |
| st-setup-a-group | 1 | 1 | 1 |
| st-logoutin | %%group_user%% | %%password%% |  |
| st-admin | add-group-admin --g %%group_id%% -e %%group_user%% |  |  |
| set | new_workspace | gui-nw-%%start_time%% |  |
| set | createme_ws_name | gui-name-ws-%%start_time%% |  |
| set | createme_ws_title | gui-title-ws-%%start_time%% |  |
| set | test_delete_ws | gui-test-delete-%%start_time%% |  |
| create_workspace | %%test_delete_ws%% |  |  |
| set | delete_ws_id | %%workspace_id%% |  |

| st-admin | create-workspace --name %%new_workspace%% --title %%new_workspace%% |  |
| open_ok | /?group/%%group_id%%/ |  |
| st-admin | add-member --w %%test_delete_ws%% --g %%group_id%% | now has the role of |

| *Comment* | Test Case: Groups UI Create New Workspace Click Edit Button |  |
| st-name-widget | 1 | information_widget |
| st-widget-title-like | information_widget | Information |
| st-select-widget-frame | information_widget |  |
| wait_for_element_visible_ok | link=(Edit) | 30000 |
| click_and_wait | link=(Edit) |  |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Groups UI Create New Workspace Get to Workspaces Widget |  |
| st-name-widget | 2 | workspaces_widget |
| st-widget-title-like | workspaces_widget | Workspaces |
| st-select-widget-frame | workspaces_widget |  |

| *Comment* | Test Case: Groups UI Create New Workspace Get to Workspaces Widget TODO check for %%group_ws%% |  |
| text_like | //body | workspace |
| *Comment* | Test Case: Groups UI Create New Workspace TODO Type in a new workspace |  |
| wait_for_element_visible_ok | new_workspace | 30000 |
| click_ok | new_workspace | 30000 |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | new-workspace-next | 30000 |
| wait_for_element_visible_ok | new_workspace_title | 30000 |
| type_ok | new_workspace_title | %%createme_ws_title%% |
| click_ok | new-workspace-next |  |
| wait_for_element_visible_ok | new-workspace-create | 30000 |
| wait_for_element_visible_ok | new-workspace-cancel | 30000 |
| wait_for_element_visible_ok | new_workspace_name | 30000 |
| type_ok | new_workspace_name | %%createme_ws_name%% |
| click_ok | new-workspace-create |  |

| *Comment* | Test Case: Groups UI Create New Workspace Save - is the new workspace there? |  |
| st-select-widget-frame | workspaces_widget |  |
| text_like | //body | %%createme_ws_title%% |
| wait_for_element_visible_ok | %%createme_ws_name%% | 30000 |
| select-frame | relative=parent |  |
| wait_for_element_visible_ok | create-group | 30000 |
| click_and_wait | create-group |  |

| *Comment* | Test Case: Groups UI Create New Workspace Look for Workspace name in widget |  |
| st-name-widget | 2 | workspaces_widget |
| st-widget-title-like | workspaces_widget | Workspaces |
| st-select-widget-frame | workspaces_widget |  |
| wait_for_element_visible_ok | link=%%createme_ws_title%% | 30000 |
| select-frame | relative=parent |  |

| *Comment* | Test Case: Groups UI Create New Workspace st-admin remove-member should fail for my user (belong is by group) |  |
| *Comment* | Test Case: Groups UI Create New Workspace st-admin remove-member - Fails due to {bz 3518} |  |
| st-admin | remove-member --w %%createme_ws_name%% --e %%group_user%% | through a group |

| *Comment* | Test Case: Groups UI Create New Workspacest-admin list-workspaces - workspace shows up for me |  |
| st-admin | list-workspaces --e %%group_user%% | %%createme_ws_name%% |
| *Comment* | Test Case: Groups UI Create New Workspace TODO check /workspace-you-just-created URL |  |
| open_ok | /%%createme_ws_name%%/ |  |
| wait_for_element_visible_ok | st-edit-button-link | 30000 |

| *Comment* | Test Case: Groups UI Create New Workspace Add %%new_workspace%% to group - lookahead fails if not admin |  |
| open_ok | /?group/%%group_id%%/ |  |
| st-name-widget | 1 | information_widget |
| st-widget-title-like | information_widget | Information |
| st-select-widget-frame | information_widget |  |
| wait_for_element_visible_ok | link=(Edit) | 30000 |
| click_and_wait | link=(Edit) |  |
| select-frame | relative=parent |  |
| st-name-widget | 2 | workspaces_widget |
| st-widget-title-like | workspaces_widget | Workspaces |
| st-select-widget-frame | workspaces_widget |  |
| wait_for_element_visible_ok | lookahead | 30000 |
| type-lookahead-ok | lookahead | %%createme_ws_name%% |
| pause | 5000 |  |
| wait_for_element_not_present_ok | %%createme_ws_name%% (%%createme_ws_title%%) | 30000 |

| *Comment* | Test Case: Groups UI Create New Workspace Add %%new_workspace%% to group - TODO test delete workspace |  |

| *Comment* | Test Case: Groups UI Create New Workspace Add %%new_workspace%% to group - TODO become admin, see lookahead |  |
| st-admin | add-workspace-admin --e %%group_user%% --w %%new_workspace%% |  |

| *Comment* | Test Case: Groups UI Create New Workspace TODO Try again - click cancel, do not see changes |  |
| *Comment* | Test Case: Groups UI Create New Workspace TODO Cancel create workspace at step1 and step2 |  |

| *Comment* | Test Case: Groups UI Create New Workspace TEARDOWN |  |
| delete-group | %%group_id%% |  |
| st-admin | delete-workspace --w %%group_ws%% --no-export |  |
| st-admin | delete-workspace --w %%new_workspace%% --no-export |  |
| st-admin | delete-workspace --w %%createme_ws_title%% --no-export |  |
| st-admin | delete-workspace --w %%test_delete_ws%% --no-export |  |

| *Comment* | Test Case: Groups UI Create New Workspace COMPLETED |  |  |
