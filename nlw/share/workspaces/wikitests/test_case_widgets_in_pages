*Failure is bug*

| *Comment* | Test Case: Widgets In Pages |  |

| set | wip_ws | widgets_wiki_%%start_time%% |
| set | wip_page | widgets_page_%%start_time%% |
| create_workspace | %%wip_ws%% |  |
| st-admin | add-member --workspace %%wip_ws%% --email %%username%% | now has the role |

| *Comment* | Test Case: Widgets In Pages make a page |  |
| open_ok | /%%wip_ws%% |  |
| wait_for_element_visible_ok | st-create-content-link | 30000 |
| click_ok | st-create-content-link |  |
| wait_for_element_visible_ok | st-create-content-savelink | 30000 |
| click_and_wait | st-create-content-savelink |  |
| wait_for_element_visible_ok | st-mode-wikitext-button | 30000 |
| click_ok | st-mode-wikitext-button |  |
| wait_for_element_visible_ok | wikiwyg_wikitext_textarea | 30000 |
| wait_for_element_visible_ok | st-newpage-pagename-edit | 30000 |
| type_ok | st-newpage-pagename-edit | %%wip_page%% |

| *Comment* | Test Case: Widgets in Pages test widget buttons, lightbox |  |
| wait_for_element_visible_ok | wikiwyg_button_widget | 30000 |
| click_ok | wikiwyg_button_widget |  |
| wait_for_element_visible_ok | st-widget-opensocial-gallery-widgets | 30000 |
| wait_for_element_visible_ok | st-widget-opensocial-gallery-cancel | 30000 |
| text_like | qr/Socialtext widgets.+Third Party widgets/ |  |
| wait_for_text_not_present_ok | Activities | 30000 |
| click_ok | st-widget-opensocial-gallery-cancel |  |
| wait_for_element_not_visible_ok | st-widget-opensocial-gallery-widgets | 15000 |
| wait_for_element_present_ok | link=Widget... | 30000 |
| click_ok | link=Widget... |  |
| wait_for_element_visible_ok | st-widget-opensocial-gallery-widgets | 30000 |
| text_like | qr/Socialtext widgets.+Third Party widgets/ |  |

| *Comment* | Test Case: Widgets in Pages add All People Tags *This test must assume that All People Tags is the first widget in the list* |  |
| text_like | qr/All People Tags.+Active Content/ |  |
| wait_for_element_visible_ok | //a[@class='greyButton' and contains(text(),'Insert')] | 30000 |
| click_ok | //a[@class='greyButton' and contains(text(),'Insert')] |  |
| wait_for_element_visible_ok | st-widget-opensocial-setup-width-options | 30000 |
| wait_for_element_visible_ok | //input[@class='searchButton st-savebutton'] | 30000 |
| click_ok | //input[@class='searchButton st-savebutton'] |  |
| wait_for_element_visible_ok | st-widget-opensocial-setup-save | 30000 |
| click_ok | st-widget-opensocial-setup-save |  |
| wait_for_element_not_visible_ok | st-widget-opensocial-gallery-widgets | 15000 |
| verifyValue | wikiwyg_wikitext_textarea | `{widget: local:people:all_tags __title__=All%20People%20Tags __width__=600 limit=all}` |

| *Comment* | Test Case: Widgets in Pages add 2nd widget, see sequential number |  |
| click_ok | link=Widget... |  |
| wait_for_element_visible_ok | st-widget-opensocial-gallery-widgets | 30000 |
| text_like | qr/Socialtext widgets.+Third Party widgets/ |  |
| text_like | qr/All People Tags.+Active Content/ |  |
| wait_for_element_visible_ok | //a[@class='greyButton' and contains(text(),'Insert')] | 30000 |
| click_ok | //a[@class='greyButton' and contains(text(),'Insert')] |  |
| wait_for_element_visible_ok | st-widget-opensocial-setup-width-options | 30000 |
| wait_for_element_visible_ok | //input[@class='searchButton st-savebutton'] | 30000 |
| click_ok | //input[@class='searchButton st-savebutton'] |  |
| wait_for_element_visible_ok | st-widget-opensocial-setup-save | 30000 |
| click_ok | st-widget-opensocial-setup-save |  |
| wait_for_element_not_visible_ok | st-widget-opensocial-gallery-widgets | 15000 |
| verifyValue | wikiwyg_wikitext_textarea | `{widget: local:people:all_tags#2 __title__=All%20People%20Tags __width__=600 limit=all}` |





| *Comment* | Test Case: Widgets in Pages TEARDOWN |  |
| st-admin | delete-workspace --workspace %%wip_ws%% --no-export | has been deleted |
