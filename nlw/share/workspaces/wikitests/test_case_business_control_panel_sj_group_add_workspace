| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace SETUP |

| set | group_name | BCP-GROUP-SJ-%%start_time%% |
| set | ws_to_add | GROUP-SJ-WS-%%start_time%% |
| set | add_ws_two | SJ-WS-TWO-%%start_time%% |
| set | fake_ws | FAKE-WS-%%start_time%% |

| st-admin | create-workspace --name %%ws_to_add%% --title %%ws_to_add%% | was created |
| st-admin | create-workspace --name %%add_ws_two%% --title %%add_ws_two%% | was created |
| st-admin | set-permissions --workspace %%ws_to_add%% --permissions public | have been changed to public |
| st-admin | set-permissions --workspace %%add_ws_two%% --permissions public | have been changed to public |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace create group via groups UI |  |
| open_ok | /nlw/control/group |  |
| wait_for_element_visible_ok | //input[@type='button' and @value="Create new Group"] | 30000 |
| click_ok | //input[@type='button' and @value="Create new Group"] |  |
| wait_for_element_visible_ok | st-groupname | 30000 |
| wait_for_element_visible_ok | st-group-create-submit | 30000 |
| type_ok | st-groupname | %%group_name%% |
| pause | 5000 |  |
| click_and_wait | st-group-create-submit |  |
| wait_for_element_visible_ok | //input[@id='addToAccountLookahead'] | 30000 |
| text_like | //body | Created By: %%short_username%% |
| text_like | //body | %%group_name%% |
| wait_for_element_visible_ok | //a[contains(text(),'%%short_username%%')] | 10000 |
| wait_for_text_present_ok | Users (1) | 10000 |
| wait_for_text_present_ok | Workspaces (0) | 30000 |
| wait_for_element_visible_ok | st-group-permission-set-selector | 30000 |
| is_selected_ok | st-group-permission-set-selector | label=Self-Join: Non-Members can view the group but must become Members to contribute. |
| get_group_id | %%group_name%% | group_id_one |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Add a workspace - See permission set enabled |  |
| wait_for_element_visible_ok | create-workspace | 30000 |
| wait_for_element_visible_ok | add-workspace | 30000 |
| pause | 5000 |  |
| is_editable | add-workspace |  |
| is_editable | create-workspace |  |

| st-config | set max_objects_for_control_panel 50000 |  |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Add Nonexistant workspace - see error |
| click_and_wait | add-workspace |  |
| wait_for_text_present_ok | Add Group To Workspace | 30000 |
| wait_for_text_present_ok | Send invitation email | 30000 |
| wait_for_element_visible_ok | send-invite-message | 30000 |
| wait_for_element_visible_ok | invite-as-admins | 30000 |
| wait_for_element_visible_ok | st-assign-to-workspace | 30000 |
| type_ok | st-assign-to-workspace | %%workspace%% |
| click-and-wait | //input[@value='Add to Workspace'] |  |
| wait_for_text_present_ok | group and workspace do not have compatible permission sets | 30000 |
| wait_for_text_present_ok | Workspaces (0) | 30000 |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Add new workspace - different permission set/error |  |
| click_and_wait | add-workspace |  |
| wait_for_text_present_ok | Add Group To Workspace | 30000 |
| wait_for_text_present_ok | Send invitation email | 30000 |
| wait_for_element_visible_ok | st-assign-to-workspace | 30000 |
| type_ok | st-assign-to-workspace | %%fake_ws%% |
| click-and-wait | //input[@value='Add to Workspace'] |  |
| wait_for_text_present_ok | No Workspace identified by %%fake_ws%% | 30000 |
| wait_for_text_present_ok | Workspaces (0) | 30000 |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Add new workspace - correct permission set |  |
| click_and_wait | add-workspace |
| wait_for_text_present_ok | Add Group To Workspace | 30000 |
| wait_for_element_visible_ok | workspace_id | 30000 |
| select_ok | workspace_id | label=%%ws_to_add%% |
| click-and-wait | //input[@value='Add to Workspace'] |  |
| wait_for_text_present_ok | No Workspace identified by %%fake_ws%% | 30000 |
| wait_for_text_present_ok | Workspaces (1) | 30000 |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Give Admin privileges |  |
| click_and_wait | add-workspace |
| wait_for_text_present_ok | Add Group To Workspace | 30000 |
| wait_for_element_visible_ok | workspace_id | 30000 |
| select_ok | workspace_id | label=%%add_ws_two%% |
| click-and-wait | //input[@value='Add to Workspace'] |  |
| wait_for_text_present_ok | Group '%%group_name%%' now has the role of member in the %%add_ws_two%% Workspace | 30000 |
| wait_for_text_present_ok | Workspaces (1) | 30000 |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Confirm Admin privileges |  |
| st-admin | show-members --w %%add_ws_two%% | admin |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Change Permissions to public |  |
| st-admin | set-permissions --permissions public --workspace add_ws_two | have been changed to public |
| open_ok | /nlw/control/group/%%group_id_one%% |  |
| wait_for_element_visible_ok | create-workspace | 30000 |
| wait_for_element_visible_ok | add-workspace | 30000 |
| pause | 5000 |  |
| st_uneditable_ok | add-workspace |  |
| st_uneditable_ok | create-workspace |  |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Change Permissions to member-only |  |
| st-admin | set-permissions --permissions member-only --workspace add_ws_two | have been changed to member-only |
| open_ok | /nlw/control/group/%%group_id_one%% |  |
| wait_for_element_visible_ok | create-workspace | 30000 |
| wait_for_element_visible_ok | add-workspace | 30000 |
| pause | 5000 |  |
| st_uneditable_ok | add-workspace |  |
| st_uneditable_ok | create-workspace |  |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Change Permissions to public-comment-only |  |
| st-admin | set-permissions --permissions public-comment-only --workspace add_ws_two | have been changed to public-comment-only |
| open_ok | /nlw/control/group/%%group_id_one%% |  |
| wait_for_element_visible_ok | create-workspace | 30000 |
| wait_for_element_visible_ok | add-workspace | 30000 |
| pause | 5000 |  |
| st_uneditable_ok | add-workspace |  |
| st_uneditable_ok | create-workspace |  |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace Change Permissions to self-join |  |
| st-admin | set-permissions --permissions public-comment-only --workspace add_ws_two | have been changed to self-join |
| open_ok | /nlw/control/group/%%group_id_one%% |  |
| wait_for_element_visible_ok | create-workspace | 30000 |
| wait_for_element_visible_ok | add-workspace | 30000 |
| pause | 5000 |  |
| is_editable | add-workspace |  |
| is_editable | create-workspace |  |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace TEARDOWN |  |
| st-admin | delete-workspace --w %%ws_to_add%% --no-export |  |
| st-admin | delete-workspace --w %%add_ws_two%% --no-export |  |
| delete_group | %%group_id%% |  |
| delete_group | %%group_id_two%% |  |

| *Comment* | Test Case: Business Control Panel SJ Group Add Workspace COMPLETED |  |
