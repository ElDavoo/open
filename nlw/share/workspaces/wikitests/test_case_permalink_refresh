* Fixture: SocialWidgets

| *Comment* | Test Case: Permalink Refresh |  |

| set | s1 | signal 001 %%start_time%% |
| set | r1 | reply 001 %%start_time%% |
| set | r2 | reply 002 %%start_time%% |
| set | r3 | reply 003 %%start_time%% |
| set | r4 | reply 004 %%start_time%% |

| *Comment* | Test Case: Permalink Refresh. send one sig and two replies |  |
| send-signal | %%s1%% |  |
| set | parent | %%signal_id%% |

| send-signal-reply | %%parent%% | %%r1%% |
| send-signal-reply | %%parent%% | %%r2%% |

| *Comment* | Test Case: Permalink Refresh. verify received |  |
| open_ok | /st/dashboard |  |
| wait_for_text_present_ok | %%s1%% | 10000 |
| wait_for_text_present_ok | %%r1%% | 10000 |
| wait_for_text_present_ok | %%r2%% | 10000 |

| *Comment* | Test Case: Permalink Refresh. Open the permalinks page and verify received |  |
| open_ok | /st/signals/%%parent%% |

| wait_for_text_present_ok | %%s1%% | 10000 |
| wait_for_text_present_ok | %%r1%% | 10000 |
| wait_for_text_present_ok | %%r2%% | 10000 |

| *Comment* | Test Case: Permalink Refresh. Send new reply and wait for it |  |
| send-signal-reply | %%parent%% | %%r3%% |
| wait_for_text_present_ok | %%r3%% | 30000 |

| *Comment* | Test Case: Permalink Refresh. Click Reply to Conversation and reply |  |
| wait_for_element_visible_ok | //a[@class='replyLink'] | 10000 |
| click_ok | //a[@class='replyLink'][last()] |  |
| wait_for_element_visible_ok | //div[@class='replies']//iframe[@name='signalFrame'] | 5000 |
| pause | 3000 |  |
| select_frame | //div[@class='replies']//iframe[@name='signalFrame'] |  |
| click_ok | //body |  |
| type_ok | //body | %%r4%% |
| select_frame | relative=parent |  |
| wait_for_element_visible_ok | //a[@class='btn post'] | 5000 |
| pause | 3000 |  |
| click_ok | //a[@class='btn post'] |  |

| *Comment* | Test Case: Permalink Refresh. Wait for the new reply |  |
| wait_for_text_present_ok | %%r4%% | 30000 |

| *Comment* | Test Case: Permalink Refresh COMPLETED |  |
