| *Comment* | Test Case: Signals Search Pagination |

* Fixture: SocialWidgets

| enable-acct-plugin | signals | %%hostname%% |

| *Comment* | Test Case: Signals Search. Two users, lexicographically orderable |  |

| set | a_username | `a-%%start_time%%@ken.socialtext.net` |
| set | z_username | `z-%%start_time%%@ken.socialtext.net` |

| set | a_name | Antiphonal Signaller %%start_time%% |
| set | z_name | Zany Replier %%start_time%% |

| create_user | %%a_username%% | %%password%% | %%hostname%% | %%a_name%% |
| create_user | %%z_username%% | %%password%% | %%hostname%% | %%z_name%% |

| *Comment* | Test Case: Signals Search. Send 22 signals %%a_username%% |  |
| http-user-pass | %%a_username%% | %%password%% |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 01"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 02"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 03"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 04"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 05"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 06"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 07"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 08"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 09"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 10"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 11"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 12"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 13"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 14"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 15"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 16"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 17"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 18"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 19"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 20"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 21"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 22"} |

| *Comment* | Test Case: Signals Search. Send 22 signals %%z_username%% |  |
| http-user-pass | %%z_username%% | %%password%% |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 41"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 42"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 43"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 44"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 45"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 46"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 47"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 48"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 49"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 50"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 51"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 52"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 53"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 54"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 55"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 56"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 57"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 58"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 59"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 60"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 61"} |
| post-json | /data/signals | {"signal":"Pagination %%start_time%% 62"} |

| http-user-pass | %%email%% | %%password%% |

| *Comment* | Test Case: Signals Search. Search for paginated signals |  |
| open_ok | /?signals |  |
| wait_for_element_visible_ok | st-search-action | 30000 |
| wait_for_element_visible_ok | st-search-term | 30000 |
| is_selected_ok | st-search-action | id=st-search-signals |
| type_ok | st-search-term | Pagination %%start_time%% |
| click_and_wait | st-search-submit |  |
| pause | 8000 | I hate pause |

| *Comment* | Test Case: Signals Search. Verify found newest Pagination %%start_time%% signals |  |
| wait_for_element_visible_ok | sort-picker | 30000 |
| select_ok | sort-picker | label=Newest |
| pause | 8000 | I Hate Pause |
| st-name-widget | 3 | searchwidget |
| st-select-widget-frame | searchwidget |  |
| text_like | Search results in all networks for 'Pagination %%start_time%%' |  |
| text_like | qr/Pagination %%start_time%% 62.+Pagination %%start_time%% 43/ism |  |

| *Comment* | Test Case: Signals Search. Older >> |  |
| wait_for_element_visible_ok | link=Older >> | 30000 |
| click_ok | link=Older >> |  |
| pause | 8000 | I Hate Pause |
| text_like | qr/Pagination %%start_time%% 42.+Pagination %%start_time%% 05/ism |  |
| pause | 8000 | I Hate Pause |
| text_like | qr/Pagination %%start_time%% 04.+Pagination %%start_time%% 01/ism |  |

^ END

| *Comment* | Test Case: Signals Search. Sort. SORT DOES NOT CAUSE PAGE LOAD |  |
| wait_for_element_visible_ok | sort-picker | 30000 |
| select_ok | sort-picker | label=Sender |
| pause | 8000 | I Hate Pause |
| text-like | qr/%%start_time%% 12.+%%start_time%% 01.+%%start_time%% 32.+%%start_time%% 21/ism |  |
| text-like | qr/%%a_name%%.+You/ism |  |
| select_ok | sort-picker | label=Newest |
| pause | 8000 | I Hate Pause |
| text-like | qr/%%start_time%% 32.+%%start_time%% 21.+%%start_time%% 12.+%%start_time%% 01/ism |  |
| text-like | qr/You.+%%a_name%%/ism |  |
| select_ok | sort-picker | label=Oldest |
| pause | 8000 | I Hate Pause |
| text-like | qr/%%start_time%% 01.+%%start_time%% 12.+%%start_time%% 21.+%%start_time%% 32/ism |  |
| text-like | qr/%%a_name%%.+You/ism |  |
| select_frame | relative=parent |  |

| *Comment* | Test Case: Signals Search. Relevance. Send a more relevant signal AND a newer signal |  |
| open_ok | /?dashboard |  |
| wait_for_element_visible_ok | link=Add Content | 30000 |
| st-name-widget | 1 | activities_widget |
| st-widget-title-like | activities_widget | Activities |
| st-send-signal-via-activities-widget | activities_widget | MoreRelevant %%start_time%% %%start_time%% %%start_time%% |
| st-send-signal-via-activities-widget | activities_widget | LessRelevant %%start_time%% |

| *Comment* | Test Case: Signals Search. Relevance. Find a more relevant signal |  |
| open_ok | /?signals |  |
| wait_for_element_visible_ok | st-search-action | 30000 |
| wait_for_element_visible_ok | st-search-term | 30000 |
| is_selected_ok | st-search-action | id=st-search-signals |
| type_ok | st-search-term | %%start_time%% |
| click_and_wait | st-search-submit |  |
| pause | 8000 | I hate Pause |

| *Comment* | Test Case: Signals Search. Verify found more relevant signal |  |
| st-name-widget | 3 | searchwidget |
| st-select-widget-frame | searchwidget |  |
| wait_for_text_present_ok | Search results in all networks for '%%start_time%%' | 30000 |
| select_ok | sort-picker | label=Relevance |
| pause | 8000 | I Hate Pause |
| text-like | qr/MoreRelevant %%start_time%% %%start_time%% %%start_time%%.+%%start_time%% 12/ism |  |

| *Comment* | Test Case: Signals Search. Verify relevant signal not newest signal |  |
| select_ok | sort-picker | label=Newest |
| pause | 8000 | I Hate Pause |
| text-like | qr/LessRelevant %%start_time%%.+MoreRelevant %%start_time%% %%start_time%% %%start_time%%.+%%start_time%% 12/ism |  |

| *Comment* | Test Case: Signals Search. Delete irrelevant signal and search again |  |
| click_ok | //a[@class='hideLink'] |  |
| verifyConfirmation | Are you sure you want to delete this Signal?\nYou cannot undelete it. |  |
| select_frame | relative=parent |  |

| *Comment* | Test Case: Signals Search. You must open Signals to clear out hidden deleted signal |  |
| open_ok | /?signals |  |
| wait_for_element_visible_ok | st-search-action | 30000 |
| wait_for_element_visible_ok | st-search-term | 30000 |
| is_selected_ok | st-search-action | id=st-search-signals |
| type_ok | st-search-term | %%start_time%% |
| click_and_wait | st-search-submit |  |
| pause | 8000 | I hate pause |

| *Comment* | Test Case: Signals Search. Verify irrelevant signal deleted |  |
| st-name-widget | 3 | searchwidget |
| st-select-widget-frame | searchwidget |  |
| text_unlike | //body | LessRelevant %%start_time%% |
| text_like | qr/MoreRelevant %%start_time%% %%start_time%% %%start_time%%.+%%start_time%% 12/ism |  |

| *Comment* | Test Case: Signals Search. Verify clear |  |
| wait_for_element_visible_ok | link=clear search results | 30000 |

WHY DOESN'T CLICK AND WAIT WORK HERE? TIMES OUT EVEN THOUGH THE PAGE LOADS ...

| click_ok | link=clear search results |  |
| pause | 8000 | I hate pause |
| select_frame | relative=parent |  |

| st-name-widget | 3 | searchwidget |
| st-widget-title-like | searchwidget | Signals |

| *Comment* | Test Case: Signals Search COMPLETED |
