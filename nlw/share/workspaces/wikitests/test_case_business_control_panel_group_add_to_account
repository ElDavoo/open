* Fixtures: Socialtext

| *Comment* | Test Case: Control Panel Group Add To Account |

| *Comment* | create needed objects |  |
| set | group | group%%start_time%% |
| set | account | account%%start_time%% |
| set | addl_account | new_account%%start_time%% |
| create-account | %%account%% |  |
| st-admin | create-account --name %%addl_account%% | was created |
| create-group | %%group%% | %%account%% |
| st_process_jobs |  |  |

| *Comment* | Test Case: Control Panel Group Add To Account Add second account to the group |  |
| st-admin | give-accounts-admin --e %%email%% | now has accounts admin access |
| setSpeed | 4000 | Need to wait for some javascript to paint the screen |
| open-ok | /nlw/control/group/%%group_id%% |  |
| wait_for_element_visible_ok | addToAccountLookahead | 3000 |
| type-lookahead-ok | addToAccountLookahead | %%addl_account%% |
| wait_for_element_visible_ok | link=%%addl_account%% | 10000 |
| click_ok | link=%%addl_account%% |  |
| wait_for_text_present_ok | Accounts (2) | 60000 |
| text_like | //body | qr/%%account%%.+%%addl_account%%/ |
| setSpeed | 0 |  |

| *Comment* | Test Case: Control Panel Group Add To Account Make sure the change 'took' by a refresh |  |
| refresh |  |  |
| wait_for_text_present_ok | Accounts (2) | 60000 |
| wait_for_element_visible_ok | accountTable | 30000 |
| pause | 1000 | Wait for javascript. Yup. Hokey |
| text_like | //body | qr/%%account%%.+%%addl_account%%/ |
| wait_for_element_visible_ok | link=%%addl_account%% | 30000 |

| *Comment* | Test Case: Control Panel Group Add To Account Remove Account from group |  |
| wait_for_element_visible_ok | accountTable-select-1 | 30000 |
| click_ok | accountTable-select-1 |  |
| wait_for_element_visible_ok | //input[@type='button' and @value="Remove from account"] | 30000 |
| click_ok | //input[@type='button' and @value="Remove from account"] |  |
| verifyConfirmation | Remove this Group from the 1 selected Account |  |
| wait_for_text_present_ok | Accounts (1) | 30000 |
| refresh |  |  |
| wait_for_text_present_ok | Accounts (1) | 30000 |
| wait_for_text_not_present_ok | %%addl_account%% | 30000 |

| *Comment* | Test Case: Control Panel Group Add To Account TEARDOWN |  |
| delete-group | %%group_id%% |  |
| st-admin | remove-accounts-admin --e %%email%% | no longer has accounts admin access |

| *Comment* | Test Case: Control Panel Group Add To Account COMPLETED |
