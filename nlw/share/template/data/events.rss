[%- USE decorate -%]
<?xml version="1.0" encoding="UTF-8"?>

<rdf:RDF
 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
 xmlns="http://purl.org/rss/1.0/"
 xmlns:content="http://purl.org/rss/1.0/modules/content/"
 xmlns:taxo="http://purl.org/rss/1.0/modules/taxonomy/"
 xmlns:dc="http://purl.org/dc/elements/1.1/"
 xmlns:syn="http://purl.org/rss/1.0/modules/syndication/"
 xmlns:admin="http://webns.net/mvcb/"
>

<channel rdf:about="[% link %]">
<title><![CDATA[[% collection_name %]]]></title>
<link>[% link %]</link>
<items>
 <rdf:Seq>
  [% FOR e = events -%]
  [%-
    IF e.event_class == 'person';
        e.uri = e.actor.id | decorate('user_href');
    ELSIF e.event_class == 'page';
        e.uri = "$base_uri/$e.page.workspace_name?$e.page.id";
    END
  -%]
  <rdf:li rdf:resource="[% e.uri %]" />
  [% END -%]
 </rdf:Seq>
</items>
</channel>
[% FOR event = events -%]
<item rdf:about="[% event.uri %]">
<link>[% event.uri %]</link>
<title><![CDATA[[% INCLUDE data/event e=event out='text' %]]]></title>
<description><![CDATA[[% INCLUDE data/event e=event out='html' %]]]></description>
</item>
[% END -%]
</rdf:RDF>
