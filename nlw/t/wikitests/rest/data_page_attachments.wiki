* Fixture: SocialRest

| set | page | my_page_%%start_time%%                            |
| set | url  | /data/workspaces/admin/pages/%%page%%/attachments |
| set | hdrs | Content-Type=text/plain |

| edit-page | admin                      | %%page%%         | Hello there |
| post      | %%url%%?name=test.txt      | %%hdrs%%         | Hi You      |
| code-is   | 201 |
| body-like |                            |                  |             |
| get       | %%url%%                    | application/json |             |
| code-is   | 200                        |                  |             |
| body-like | content-type":"text/plain" |                  |             |
| body-like | "name":"test.txt"          |                  |             |

| set-from-content | file_url     | qr/"uri":"([^"]+)"/ |
| get              | %%file_url%% |                     |
| code-is          | 200          |                     |
| body-like        | Hi You       |                     |
| has-header       | Content-type | text/plain          |

* Try out the permalink URL

| get         | %%url%%/test.txt    |                     |
| code-is     | 200                 |                     |
| body-like   | Hi You              |                     |
| has-header  | Content-type        | text/plain          |
| header-like | Content-Disposition | filename="test.txt" |
